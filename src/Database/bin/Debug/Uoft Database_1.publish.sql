/*
Deployment script for UoftDatabase

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "UoftDatabase"
:setvar DefaultFilePrefix "UoftDatabase"
:setvar DefaultDataPath ""
:setvar DefaultLogPath ""

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ANSI_NULLS ON,
                ANSI_PADDING ON,
                ANSI_WARNINGS ON,
                ARITHABORT ON,
                CONCAT_NULL_YIELDS_NULL ON,
                QUOTED_IDENTIFIER ON,
                ANSI_NULL_DEFAULT ON 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ALLOW_SNAPSHOT_ISOLATION OFF;
    END


GO
PRINT N'Rename refactoring operation with key 0f529091-5b27-42fa-8011-d3c7b2c57139 is skipped, element [dbo].[Time].[BuildingID] (SqlSimpleColumn) will not be renamed to SessionID';


GO
PRINT N'Rename refactoring operation with key 5817a476-3b74-489b-889f-1bee188a6410 is skipped, element [dbo].[Time].[StartTime] (SqlSimpleColumn) will not be renamed to BuildingID';


GO
PRINT N'Rename refactoring operation with key 7391642b-b0ec-4bba-bfd3-d03ea2c386a8 is skipped, element [dbo].[Time].[EndTime] (SqlSimpleColumn) will not be renamed to StartTime';


GO
PRINT N'Rename refactoring operation with key 05cd580f-7f48-4d43-9e14-ea101fd722c9 is skipped, element [dbo].[Building Distances].[TransitTime] (SqlSimpleColumn) will not be renamed to TransitDuration';


GO
PRINT N'Rename refactoring operation with key 7ecd557f-7792-4f21-89f8-75012e37e7c2 is skipped, element [dbo].[Building Distances].[WalkTime] (SqlSimpleColumn) will not be renamed to WalkingDuration';


GO
PRINT N'Rename refactoring operation with key ad460afa-c783-4458-9eb5-326180cdaf4a, bcb58afb-2982-4b4f-976f-da382d4eb9da is skipped, element [dbo].[Lecture].[Id] (SqlSimpleColumn) will not be renamed to SessionID';


GO
PRINT N'Rename refactoring operation with key 2d373f26-9234-4ac8-8b5c-c99e01077031, 65a76173-a984-4174-882e-8b00d82cb417, 78f29ace-add6-4d84-8424-ec8525763003 is skipped, element [dbo].[Lecture].[Instructor] (SqlSimpleColumn) will not be renamed to Type';


GO
PRINT N'Rename refactoring operation with key cd612317-a957-4ad4-8f09-fed3960d8323 is skipped, element [dbo].[Time].[Day] (SqlSimpleColumn) will not be renamed to EndTime';


GO
PRINT N'Rename refactoring operation with key 2e4375e0-b1fc-464e-b215-0ea306c79833 is skipped, element [dbo].[MeetingSession].[SessionID] (SqlSimpleColumn) will not be renamed to ActivityID';


GO
PRINT N'Rename refactoring operation with key b139aeba-73b0-4f42-aebf-a26263db00c0 is skipped, element [dbo].[MeetingSession].[MeetingCode] (SqlSimpleColumn) will not be renamed to ActivityCode';


GO
PRINT N'Rename refactoring operation with key e945f29e-429b-4155-924c-81005400e0e2 is skipped, element [dbo].[Time].[SessionID] (SqlSimpleColumn) will not be renamed to ActivityID';


GO
PRINT N'Rename refactoring operation with key 356e46ce-52e6-449b-b9f0-c7a3c5d5d4be, 37114e32-bc0a-4c77-8d90-90ca4d447590 is skipped, element [dbo].[Course].[Name] (SqlSimpleColumn) will not be renamed to Title';


GO
PRINT N'Rename refactoring operation with key 3d0ac563-0830-4198-9677-540e7c2e8901 is skipped, element [dbo].[Course].[CourseCode] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 62d1a6a3-b6c2-495b-babd-a67101e6fcbb is skipped, element [dbo].[Activity].[Type] (SqlSimpleColumn) will not be renamed to ActivityType';


GO
PRINT N'Rename refactoring operation with key 8289d1d8-d47b-4445-897f-7198580dc11d, 03ddf1b1-6170-4436-a6e1-82dc1d0dd872 is skipped, element [dbo].[Session].[BuildingID] (SqlSimpleColumn) will not be renamed to Fall_BuildingID';


GO
PRINT N'Rename refactoring operation with key 49bf84fc-3a50-48e0-bfa9-1942f89c1aaf is skipped, element [dbo].[Session].[RoomNumber] (SqlSimpleColumn) will not be renamed to Fall_RoomNumber';


GO
PRINT N'Rename refactoring operation with key bcaebdf5-8440-4358-85ac-eaa9f8b4398f is skipped, element [dbo].[Session].[WINTER_BuildingID] (SqlSimpleColumn) will not be renamed to Winter_BuildingID';


GO
PRINT N'Rename refactoring operation with key c40eac7c-6863-4bfe-bfed-f78a8c4c18d0 is skipped, element [dbo].[Session].[WINTER_RoomNumber] (SqlSimpleColumn) will not be renamed to Winter_RoomNumber';


GO
PRINT N'Rename refactoring operation with key b3dc40f4-9ef5-495a-b3ae-39dd722bf7c0, fff4cf0e-0560-4be4-9770-5fc715e13613 is skipped, element [dbo].[Course].[Id] (SqlSimpleColumn) will not be renamed to CourseID';


GO
PRINT N'Rename refactoring operation with key 9a61f2e3-1160-4445-a6e7-66f4f4fef5f3 is skipped, element [dbo].[Activity].[ActivityId] (SqlSimpleColumn) will not be renamed to ActivityID';


GO
PRINT N'Rename refactoring operation with key 09162a5c-b58f-4ce4-b8b9-948a1715c15f is skipped, element [dbo].[Section].[Id] (SqlSimpleColumn) will not be renamed to SectionID';


GO
PRINT N'Rename refactoring operation with key 5aa2de70-15f9-45ce-a5db-38ecc9459167 is skipped, element [dbo].[Session].[ActivityID] (SqlSimpleColumn) will not be renamed to SectionID';


GO
PRINT N'Rename refactoring operation with key 9d58580c-fe44-4883-86aa-090fff1d5faa is skipped, element [dbo].[Session].[Id] (SqlSimpleColumn) will not be renamed to SessionID';


GO
PRINT N'Rename refactoring operation with key 2df00f43-e844-4c5e-9089-f25359c78e81, ce7dc5a9-4293-4fba-8a7e-8bc287623962 is skipped, element [dbo].[BuildingDistances].[Id] (SqlSimpleColumn) will not be renamed to BuildingDistanceID';


GO
PRINT N'Rename refactoring operation with key e079dccd-85e0-408c-b66f-257febf9dbda is skipped, element [dbo].[Building].[Id] (SqlSimpleColumn) will not be renamed to BuildingID';


GO
PRINT N'Rename refactoring operation with key d66d028f-dc42-4336-b9d8-1fd2da8bdf1d is skipped, element [dbo].[BuildingDistances].[VehicleDistance] (SqlSimpleColumn) will not be renamed to DrivingDistance';


GO
PRINT N'Rename refactoring operation with key ccbb04c5-bcd6-4d56-b9ae-03a37c6c01f8 is skipped, element [dbo].[BuildingDistances].[VehicleDuration] (SqlSimpleColumn) will not be renamed to DrivingDuration';


GO
PRINT N'Rename refactoring operation with key bba069fe-7974-4ac3-bddc-fcfb3a7b09cb is skipped, element [dbo].[InstructorToActivity].[ActivityID] (SqlSimpleColumn) will not be renamed to SectionID';


GO
PRINT N'Rename refactoring operation with key 0000660e-c5fc-43f5-9a41-6ce8a54d92fb is skipped, element [dbo].[Instructor].[Id] (SqlSimpleColumn) will not be renamed to InstructorID';


GO
PRINT N'Creating [dbo].[Activity]...';


GO
CREATE TABLE [dbo].[Activity] (
    [ActivityID]   INT      IDENTITY (1, 1) NOT NULL,
    [CourseID]     INT      NOT NULL,
    [ActivityType] CHAR (1) NULL,
    PRIMARY KEY CLUSTERED ([ActivityID] ASC)
);


GO
PRINT N'Creating [dbo].[Building]...';


GO
CREATE TABLE [dbo].[Building] (
    [BuildingID]   INT            IDENTITY (1, 1) NOT NULL,
    [BuildingName] NVARCHAR (MAX) NULL,
    [BuildingCode] NVARCHAR (2)   NULL,
    [Address]      NVARCHAR (MAX) NULL,
    [Latitude]     FLOAT (53)     NULL,
    [Longitude]    FLOAT (53)     NULL,
    PRIMARY KEY CLUSTERED ([BuildingID] ASC)
);


GO
PRINT N'Creating [dbo].[BuildingDistances]...';


GO
CREATE TABLE [dbo].[BuildingDistances] (
    [BuildingDistanceID] INT        IDENTITY (1, 1) NOT NULL,
    [BuildingID1]        INT        NOT NULL,
    [BuildingID2]        INT        NOT NULL,
    [WalkingDuration]    FLOAT (53) NULL,
    [WalkingDistance]    FLOAT (53) NULL,
    [TransitDuration]    FLOAT (53) NULL,
    [TransitDistance]    FLOAT (53) NULL,
    [CyclingDuration]    FLOAT (53) NULL,
    [CyclingDistance]    FLOAT (53) NULL,
    [DrivingDuration]    FLOAT (53) NULL,
    [DrivingDistance]    FLOAT (53) NULL,
    PRIMARY KEY CLUSTERED ([BuildingDistanceID] ASC)
);


GO
PRINT N'Creating [dbo].[Course]...';


GO
CREATE TABLE [dbo].[Course] (
    [CourseID]    INT            IDENTITY (1, 1) NOT NULL,
    [Code]        NVARCHAR (10)  NULL,
    [Campus]      NVARCHAR (MAX) NULL,
    [Term]        CHAR (1)       NULL,
    [Title]       NVARCHAR (MAX) NULL,
    [Description] NVARCHAR (MAX) NULL,
    PRIMARY KEY CLUSTERED ([CourseID] ASC)
);


GO
PRINT N'Creating [dbo].[Instructor]...';


GO
CREATE TABLE [dbo].[Instructor] (
    [InstructorID] INT            IDENTITY (1, 1) NOT NULL,
    [Name]         NVARCHAR (MAX) NULL,
    [Rating]       FLOAT (53)     NULL,
    PRIMARY KEY CLUSTERED ([InstructorID] ASC)
);


GO
PRINT N'Creating [dbo].[InstructorToSection]...';


GO
CREATE TABLE [dbo].[InstructorToSection] (
    [Id]           INT IDENTITY (1, 1) NOT NULL,
    [InstructorID] INT NOT NULL,
    [SectionID]    INT NOT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating [dbo].[Section]...';


GO
CREATE TABLE [dbo].[Section] (
    [SectionID]   INT            IDENTITY (1, 1) NOT NULL,
    [ActivityID]  INT            NOT NULL,
    [SectionCode] NVARCHAR (MAX) NULL,
    PRIMARY KEY CLUSTERED ([SectionID] ASC)
);


GO
PRINT N'Creating [dbo].[Session]...';


GO
CREATE TABLE [dbo].[Session] (
    [SessionID]         INT            IDENTITY (1, 1) NOT NULL,
    [SectionID]         INT            NOT NULL,
    [Fall_BuildingID]   INT            NULL,
    [Fall_RoomNumber]   NVARCHAR (MAX) NULL,
    [Winter_BuildingID] INT            NULL,
    [Winter_RoomNumber] NVARCHAR (MAX) NULL,
    [StartTime]         FLOAT (53)     NULL,
    [EndTime]           FLOAT (53)     NULL,
    PRIMARY KEY CLUSTERED ([SessionID] ASC)
);


GO
PRINT N'Creating unnamed constraint on [dbo].[Activity]...';


GO
ALTER TABLE [dbo].[Activity] WITH NOCHECK
    ADD FOREIGN KEY ([CourseID]) REFERENCES [dbo].[Course] ([CourseID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[BuildingDistances]...';


GO
ALTER TABLE [dbo].[BuildingDistances] WITH NOCHECK
    ADD FOREIGN KEY ([BuildingID1]) REFERENCES [dbo].[Building] ([BuildingID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[BuildingDistances]...';


GO
ALTER TABLE [dbo].[BuildingDistances] WITH NOCHECK
    ADD FOREIGN KEY ([BuildingID2]) REFERENCES [dbo].[Building] ([BuildingID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[InstructorToSection]...';


GO
ALTER TABLE [dbo].[InstructorToSection] WITH NOCHECK
    ADD FOREIGN KEY ([InstructorID]) REFERENCES [dbo].[Instructor] ([InstructorID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[InstructorToSection]...';


GO
ALTER TABLE [dbo].[InstructorToSection] WITH NOCHECK
    ADD FOREIGN KEY ([SectionID]) REFERENCES [dbo].[Section] ([SectionID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[Section]...';


GO
ALTER TABLE [dbo].[Section] WITH NOCHECK
    ADD FOREIGN KEY ([ActivityID]) REFERENCES [dbo].[Activity] ([ActivityID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[Session]...';


GO
ALTER TABLE [dbo].[Session] WITH NOCHECK
    ADD FOREIGN KEY ([SectionID]) REFERENCES [dbo].[Section] ([SectionID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[Session]...';


GO
ALTER TABLE [dbo].[Session] WITH NOCHECK
    ADD FOREIGN KEY ([Fall_BuildingID]) REFERENCES [dbo].[Building] ([BuildingID]);


GO
PRINT N'Creating unnamed constraint on [dbo].[Session]...';


GO
ALTER TABLE [dbo].[Session] WITH NOCHECK
    ADD FOREIGN KEY ([Winter_BuildingID]) REFERENCES [dbo].[Building] ([BuildingID]);


GO
PRINT N'Creating [dbo].[Activity].[ActivityType].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'0 = Lecture, 1 = Tutorial, 2 = Practical', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Activity', @level2type = N'COLUMN', @level2name = N'ActivityType';


GO
